{"version":3,"sources":["file:///Users/zhangxinxin/NewProject_1/assets/Script/item_pic_nodeEvent.ts"],"names":["_decorator","Component","UITransform","Node","v3","ccclass","property","item_pic_nodeEvent","start","node","on","EventType","TOUCH_START","onTouchAllStart","TOUCH_MOVE","onTouchMove","TOUCH_END","onTouchEnd","TOUCH_CANCEL","onTouchCancel","update","deltaTime","onTouchStart","event","uiPos","getUILocation","console","log","setScale","transform","getComponent","nodePos","convertToNodeSpaceAR","x","y","setPosition","position","edgeWidth","moveSpeed","newPosition","clone","Math","abs","delta","getUIDelta","dx","dy"],"mappings":"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","sourcesContent":["import { _decorator, Component, EventTouch, UITransform, Node, v3 } from 'cc';\nconst { ccclass, property } = _decorator;\n\n@ccclass('item_pic_nodeEvent')\nexport class item_pic_nodeEvent extends Component {\n    @property\n    moveSpeed: number = 200; // 移动速度\n\n\n\n    start() {\n        this.node.on(Node.EventType.TOUCH_START, this.onTouchAllStart, this);\n        this.node.on(Node.EventType.TOUCH_MOVE, this.onTouchMove, this);\n        this.node.on(Node.EventType.TOUCH_END, this.onTouchEnd, this);\n        this.node.on(Node.EventType.TOUCH_CANCEL, this.onTouchCancel, this);\n    }\n\n    update(deltaTime: number) {\n        \n    }\n\n    // event: EventTouch\n    onTouchStart(event: EventTouch) {\n        const uiPos = event.getUILocation();\n        console.log(\"onTouchStart\");\n        this.node.setScale(1.2, 1.2);\n\n        // 转换坐标并进行移动\n        const transform = this.node.getComponent(UITransform);\n        const nodePos = transform.convertToNodeSpaceAR(v3(uiPos.x, uiPos.y, 0));\n        if (nodePos.x > 0) {\n            // 右半侧\n            this.node.setPosition(this.node.position.x + 50 , this.node.position.y, 0);\n        }else {\n            this.node.setPosition(this.node.position.x - 50 , this.node.position.y, 0);\n        }\n    }\n\n    // 支持上下左右移动\n    onTouchAllStart(event: EventTouch){\n        const uiPos = event.getUILocation();\n        console.log(\"onTouchStart\");\n        this.node.setScale(1.2, 1.2);\n    \n        // 转换坐标并进行移动\n        const transform = this.node.getComponent(UITransform);\n        const nodePos = transform.convertToNodeSpaceAR(v3(uiPos.x, uiPos.y, 0));\n    \n        // 定义边缘触发范围的宽度\n        const edgeWidth = 40;\n    \n        // 检查触摸点是否在节点的边缘范围内\n        if (\n            nodePos.x > -edgeWidth && \n            nodePos.x < edgeWidth &&\n            nodePos.y > -edgeWidth &&\n            nodePos.y < edgeWidth\n        ) {\n            // 在边缘范围内，触发移动\n            const moveSpeed = this.moveSpeed; // 获取移动速度\n            const newPosition = this.node.position.clone();\n    \n            if (Math.abs(nodePos.x) > Math.abs(nodePos.y)) {\n                // 横向位移大于纵向位移，左右移动\n                if (nodePos.x > 0) {\n                    newPosition.x += moveSpeed;\n                } else {\n                    newPosition.x -= moveSpeed;\n                }\n            } else {\n                // 纵向位移大于横向位移，上下移动\n                if (nodePos.y > 0) {\n                    newPosition.y += moveSpeed;\n                } else {\n                    newPosition.y -= moveSpeed;\n                }\n            }\n    \n            this.node.setPosition(newPosition);\n        }\n    }\n\n    onTouchMove(event: EventTouch) {\n        console.log(\"onTouchMove\");\n\n        const delta = event.getUIDelta();\n        const dx = delta.x;\n        const dy = delta.y;\n        const x = this.node.position.x + dx;\n        const y = this.node.position.y + dy;\n        this.node.setPosition(x, y);\n    } \n    \n    onTouchEnd(event: EventTouch) {\n        console.log(\"onTouchEnd\");\n        this.node.setScale(1, 1);\n\n    }\n\n    onTouchCancel(event: EventTouch) {\n        console.log(\"onTouchCancel\");\n        this.node.setScale(1, 1);\n    }\n}\n\n"]}